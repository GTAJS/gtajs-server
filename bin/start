#!/usr/bin/env node

import log from 'cuvva-log';
import http from 'http';
import App from '../app';
import Server from '../lib/comms/server';

log.setHandler('fatal', () => { process.exit(1); });

const httpServer = http.createServer(App);
const server = new Server(httpServer);

App.set('server', server);

const port = process.env.PORT || 10311;
httpServer.listen(port, () => log.info('http_listening', { port: port }));
